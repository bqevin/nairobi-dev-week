function formatDateForHotel(e){var t=$("#"+e).datepicker("getDate"),a=t.getMonth()+1,r=t.getDate();10>r&&(r="0"+r),10>a&&(a="0"+a),$("#"+e).val(t.getFullYear()+"-"+a+"-"+r)}function validEmail(e){var t=$(e).val();return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,26})+$/.test(t)?!0:!1}function isValidUSZip(e){var t=/^([0-9]{5})(?:[-\s]*([0-9]{4}))?$/;return t.test(e)}function fbLogin(){FB.login(function(e){"connected"===e.status?($(".register-form").show(),$("#btn-register-with-email").hide(),fetchFbData()):"not_authorized"===e.status},{scope:"public_profile,email"})}function fbLoginApplication(){FB.login(function(e){"connected"===e.status?fetchApplicationFbData():"not_authorized"===e.status},{scope:"public_profile,email"})}function fetchApplicationFbData(){FB.api("/me",{fields:"first_name,last_name,email"},function(e){e.hasOwnProperty("email")&&$("#emailAddress").val(e.email),e.hasOwnProperty("id")&&$("#facebook_id").val(e.id),$("#application-short").trigger("click")})}function fetchFbData(){FB.api("/me",{fields:"first_name,last_name,email"},function(e){e.hasOwnProperty("first_name")&&$("#firstName").val(e.first_name),e.hasOwnProperty("email")&&$("#emailAddress").val(e.email),e.hasOwnProperty("last_name")&&$("#lastName").val(e.last_name),e.hasOwnProperty("id")&&$("#facebook_id").val(e.id),$("#watch").length>0?postWatchF8():($("#fb-register-button").hide(),$("#facebook-button-group label").hide(),TweenLite.set(".facebook-login-success",{display:"block",alpha:0}),TweenLite.to(".facebook-login-success",.4,{alpha:1}))})}function checkHotelField(e){if($("#"+e).length>0&&($("#"+e).parent().removeClass("error"),""==$("#"+e).val())){$("#"+e).parent().addClass("error"),$("#"+e).parent().find(".help-text").show();var t=$("#"+e).offset().top;return t-=50,-1==scrollToValue&&(scrollToValue=t),!1}return!0}function checkGeneralField(e){if($("#"+e).length>0&&($("#"+e).parent().parent().removeClass("error"),""==$("#"+e).val())){$("#"+e).parent().parent().addClass("error"),$("#"+e).parent().parent().find(".help-text").show();var t=$("#"+e).offset().top;return t-=50,scrollToValue=t,!1}return!0}function checkSelectbox(e){if($("#"+e).length>0){$("#"+e).parent().parent().removeClass("error");var t=$("#"+e).find(":selected").val();if(""===t){$("#"+e).parent().parent().addClass("error"),"country"==e?$("#"+e).parent().parent().parent().find(".help-text").show():$("#"+e).parent().parent().find(".help-text").show();var a=$("#"+e).offset().top;return a-=50,-1==scrollToValue&&(scrollToValue=a),!1}}return!0}function checkSelectboxErrorOnLevel1(e){if($("#"+e).length>0){$("#"+e).parent().removeClass("error");var t=$("#"+e).find(":selected").val();if(""===t){$("#"+e).parent().addClass("error"),$("#"+e).parent().parent().parent().find(".help-text").show();var a=$("#"+e).offset().top;return a-=50,-1==scrollToValue&&(scrollToValue=a),!1}}return!0}function checkRadio(e){if($("input."+e).length>0){if($("input."+e+":checked").length>0)return!0;$("input."+e+":first").parent().parent().parent().addClass("error"),$("input."+e+":first").parent().parent().parent().find(".help-text").show();var t=$("input."+e+":first").offset().top;return t-=50,-1==scrollToValue&&(scrollToValue=t),!1}return!0}function checkForm(e){scrollToValue=-1;var t=!1;$(".help-text").hide();for(var a=new Array("firstName","lastName","emailAddress","companyName","jobTitle"),r=0;r<a.length;r++)checkGeneralField(a[r])===!1&&(t=!0);var n=validEmail($("#emailAddress"));if(n===!1){t=!0,$("#emailAddress").parent().parent().addClass("error"),$("#emailAddress").parent().parent().find(".help-text").show();var i=$("#emailAddress").offset().top;i-=50,-1==scrollToValue&&(scrollToValue=i)}for(var o=new Array("jobTitle","country","category"),r=0;r<o.length;r++)if(checkSelectbox(o[r])===!1&&(t=!0),"country"==o[r]&&"US"==$("#country").val()){$("#zipCode").parent().removeClass("error");var l=isValidUSZip($("#zipCode").val());if(l===!1){t=!0,$("#zipCode").parent().addClass("error");var i=$("#zipCode").offset().top;i-=50,-1==scrollToValue&&(scrollToValue=i)}}for(var o=new Array("gender","ethnicity"),r=0;r<o.length;r++)checkSelectboxErrorOnLevel1(o[r])===!1&&(t=!0);for(var s=new Array("partner-breakfast"),r=0;r<s.length;r++)checkRadio(s[r])===!1&&(t=!0);var c=$("input[name='hotel_needed']:checked").val();return"1"==c&&(checkHotelField("checkIn")===!1&&(t=!0),checkHotelField("checkOut")===!1&&(t=!0)),scrollToValue>-1&&$("html, body").animate({scrollTop:scrollToValue},1e3),t?!1:e&&$("#stripe_status").length>0&&"complete"!==$("#stripe_status").val()?!1:!0}function startStripePayment(){return"new"==$("#stripe_status").val()?(stripeHandler.open({email:$("#emailAddress").val(),name:$("#product_title").val(),description:$("#product_description").val(),amount:100*$("#product_price").val(),allowRememberMe:!1}),!1):void 0}function postWatchF8(){var e=$("#watch").serialize();request=$.ajax({url:$("#watch").attr("action"),type:"post",data:e}),request.done(function(e){document.location.href=e.redirect_to}),request.fail(function(){})}function watchFormOk(){var e=!1;$(".help-text").hide();for(var t=new Array("firstName","lastName","emailAddress"),a=0;a<t.length;a++)e||checkGeneralField(t[a])===!1&&(e=!0);if(e===!1&&!validEmail("#emailAddress")){$("#emailAddress").parent().parent().addClass("error"),$("#emailAddress").parent().parent().find(".help-text").show();var r=$("#emailAddress").offset().top;r-=50,$("html, body").animate({scrollTop:r},500),e=!0}return e?!1:!0}var scrollToValue=-1;$(document).ready(function(){$("#ethnicity").change(function(){""!=$(this).val()&&($(this).parent().removeClass("error"),$(this).parent().parent().parent().find(".help-text").hide())}),$("#gender").change(function(){""!=$(this).val()&&($(this).parent().removeClass("error"),$(this).parent().parent().parent().find(".help-text").hide())}),$("#country").change(function(){""!=$(this).val()&&($("#country").parent().parent().removeClass("error"),$("#country").parent().parent().parent().find(".help-text").hide())}),$("#jobTitle").change(function(){""!=$(this).val()&&($("#country").parent().parent().removeClass("error"),$("#country").parent().parent().find(".help-text").hide())}),$("#payment").length>0&&$("#submit-button").hide(),$("#watch").submit(function(){return watchFormOk()&&postWatchF8(),!1}),$("#hotel_yes").click(function(){$(".hotel-yes").show()}),$("#hotel_no").click(function(){$(".hotel-yes").hide()}),$("#stripe_public").length>0&&(stripeHandler=StripeCheckout.configure({key:$("#stripe_public").val(),image:"https://s3-us-west-2.amazonaws.com/fb-regs/fbf8-live/stripe-avatar.png",token:function(e){$("#submit-button").show(),$("#stripe_email").val(e.email),$("#stripe_token").val(e.id),$("#stripe_status").val("complete"),$(".payment-failed").hide(),$("#verify-payment").hide(),$("#verification-complete").show();var t=$("#verification-complete").offset().top;return t-=50,$("html, body").animate({scrollTop:t},500),!1},closed:function(){if("complete"!=$("#stripe_status").val()){$("#payment").show(),$("#verify-payment").hide(),$(".payment-failed").show();var e=$("#payment").offset().top;e-=50,$("html, body").animate({scrollTop:e},500)}return!1}})),$(".help-text").hide(),$("#start-payment").click(function(){var e=checkForm(!1);e===!0&&($("#payment").hide(),$("#verify-payment").show(),startStripePayment())}),$("#application").submit(function(){var e=checkForm(!1);if(e===!0){var t=$("#application").serialize(),a=$.ajax({url:$("#application").attr("action"),type:"post",data:t});a.done(function(e){document.location.href="/confirm-application/"+e.guid})}return!1}),$("#application-short").click(function(){var e=validEmail("#emailAddress");if(0==e){$("#email-application-invalid").show();var t=$("#emailAddress").offset().top;return t-=50,$("html, body").animate({scrollTop:t},500),!1}if(e||"0"!=$("#facebook_id").val()){var a="_token="+$("#_token").val();a+="&application[facebook_id]="+$("#facebook_id").val(),a+="&application[email]="+$("#emailAddress").val();var r=$.ajax({url:"/application",type:"post",data:a});r.done(function(e){document.location.href="/confirm-application/"+e.guid})}return!1}),$("#registration").submit(function(){var e=checkForm(!0);if(e===!0){$("#submit-button").hide(),$("#submit-process").show();var t=$("input[name='hotel_needed']:checked").val();"1"==t&&(formatDateForHotel("checkIn"),formatDateForHotel("checkOut"));var a=$("#registration").serialize();request=$.ajax({url:$("#registration").attr("action"),type:"post",data:a}),request.done(function(e){if(e.success===!1){$("#submit-button").hide(),$("#submit-process").hide(),$("#stripe_status").val("new"),$("#payment").show(),$("#verification-complete").hide(),$(".payment-failed").show();var t=$("#payment").offset().top;t-=50,$("html, body").animate({scrollTop:t},500)}else document.location.href=e.url}),request.fail(function(){document.location.href=data.url})}return!1}),$("#fb-application-button").click(function(){return fbLoginApplication(),!1}),$("#fb-register-button").click(function(){return fbLogin(),!1}),$("#btn-register-with-email").click(function(){return $(".register-form").show(),$("#btn-register-with-email").hide(),!1}),$("#rsvp-check").submit(function(){var e="/f8/invitevalidation",t={_token:$("#_token").val(),invite:$("#invite-code").val()};return $("#invite-code").parent().removeClass("error"),$.ajax({type:"POST",url:e,data:t,success:function(e){0==e.success?($("#invite-code").parent().addClass("error"),$("#invite-invalid").show()):document.location.href=e.redirect_to}}),!1})});